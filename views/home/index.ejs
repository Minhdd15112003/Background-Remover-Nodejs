<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Xóa phông nền ảnh</title>
  <link rel="stylesheet" href="stylesheets/style.css">
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.10.2/dist/full.min.css" rel="stylesheet" type="text/css" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
  <form method="post" action="/uploadImage" enctype="multipart/form-data">
    <div class="hero min-h-screen bg-base-200">
      <div class="hero-content flex-col lg:flex-row-reverse">
        <img id="output" src="https://daisyui.com/images/stock/photo-1635805737707-575885ab0820.jpg" class="w-80 rounded-lg shadow-2xl" />
        <div>
          <h1 class="text-5xl font-bold text-base-content">Xóa phông nền Background!</h1>
          <p class="py-6 text-base-content">vui lòng chọn ảnh cần xóa!!.</p>
          <div class="flex justify-center items-center"> <input accept="image/*" name="image" type="file" class="file-input file-input-bordered file-input-primary w-full max-w-xs text-base-content" id="imageInput" onchange="handleImageUpload(event)" />
            <div id="btn-download">
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</body>

</html>
<script>
  const $ = document.querySelector.bind(document);
  const btnDownload = $('#btn-download');

  function handleImageUpload(event) {

    btnDownload.innerHTML = '<span class="ms-5 loading loading-spinner loading-lg"></span>'
    const file = event.target.files[0];
    const formData = new FormData();
    formData.append('image', file);
    fetch('/uploadImage', {
        method: 'POST',
        body: formData
      })
      .then(response => response.json()).then(data => {
        const img = document.getElementById('output');
        img.src = data.path;
        let tmpHTML = '<a download="' + data.path + '" href="' + data.path + '" class="btn btn-primary" style="margin-left: 38px;" type="button">Tải ảnh xuống</a>'
        btnDownload.innerHTML = tmpHTML
      })
      .catch(error => {
        console.error('Error:', error);
        // btnDownload.innerHTML = tmpHTML
      });
  }
</script>